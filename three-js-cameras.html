
<polymer-element name="three-js-camera" extends="three-js-object" constructor="threeJsCamera" attributes="aspect fov near far lookAt up">
  <script>
    Polymer('three-js-camera', {
      lookAt: '',
      aspect: 16 / 9,
      fov: 40,
      near : 0.2,
      far: 1000,
      up:[0,1,0],
      object: null,
      ready: function() {
        this.cameraUp = new THREE.Vector3(this.up[0],this.up[1],this.up[2]);  
        this.super();
      },
      /*updatePosition: function() {
        this.super();
        this.lookAtChanged();
      },*/
      //attribute change handlers
      aspectChanged:function() {
        this.object.aspect = this.aspect;
      },
      fovChanged:function() {
        this.object.fov = this.fov;
      },
      nearChanged:function() {
        this.object.near = this.near;
      },
      farChanged:function() {
        this.object.far = this.far;
      },
      upChanged:function(){
        this.cameraUp = new THREE.Vector3(this.up[0],this.up[1],this.up[2]);  
        this.camera.up = this.cameraUp;
      },
      lookAtChanged: function() {
        if(this.lookAt)
        {
          var node = this.parentNode.querySelector(this.lookAt);
          if (node /*&& node.object*/) {
            this.object.lookAt(node);
          }
        }
        else{this.object.lookAt(new THREE.Vector3());}
      }
    });
  </script>
</polymer-element>

<polymer-element name="three-js-perspectiveCamera" extends="three-js-camera">
  <script>
    Polymer('three-js-perspectiveCamera', {
      ready: function() {
        this.object = new THREE.PerspectiveCamera(this.fov, this.aspect, this.near, this.far);
        this.super();
      },
      lookAtChanged: function() {
        console.log("look at changed", this.lookAt)
        if(this.lookAt)
        {
          var node = this.parentNode.querySelector(this.lookAt);
          if (node /*&& node.object*/) {
            this.object.lookAt(node);
          }
        }
        else{this.object.lookAt(new THREE.Vector3());}
      }
    });
  </script>
</polymer-element>

<script src="lib/CombinedCamera.js"></script>

<polymer-element name="three-js-combinedCamera" extends="three-js-camera" attributes="projection orientation ortho">
  <script>
    Polymer('three-js-combinedCamera', {
      projection: "perspective",
      orientation: "diagonal",
      ortho:false,
      object: null,
      ready: function() {
        //todo: read camera params from camera config/settings ?
		    this.defaultCameraPosition = new THREE.Vector3(100,100,200);
        this.camera = new THREE.CombinedCamera(
          this.width,
          this.height,
          this.fov,
          this.near,
          this.far,
          this.near,
          this.far);
        this.camera.up = this.cameraUp;
        this.camera.position.copy(this.defaultCameraPosition);
        this.camera.defaultPosition.copy(this.defaultCameraPosition);
        
        this.object = this.camera;
        this.super();
      },
      /*updatePosition: function() {
        this.super();
      },*/
      //attribute change handlers / various handlers
      projectionChanged:function()
	    {
		    //console.log("projectionChanged", this.projection);
		    if(this.projection == "orthographic")
		    {
				    this.camera.toOrthographic();
		    }
		    else
		    {
            this.camera.toPerspective();
		    }
	    },
	    orthoChanged:function()
	    {
	      if(this.ortho)
	      {
	        this.camera.toOrthographic();
	      }
	      else{
	        this.camera.toPerspective();
	      }
	    },
      orientationChanged:function()
	    {
			    console.log("orientation changed to", this.orientation);
          var orientation = this.orientation;
          var methodName = "to"+orientation.charAt(0).toUpperCase() + orientation.slice(1)+"View";
          try{
            this.camera[methodName]();
          }catch(error){console.log(error);}
	    },
  
    });
  </script>
</polymer-element>
