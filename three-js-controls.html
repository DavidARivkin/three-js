<polymer-element name="three-js-controls" constructor="threeJsControls" noscript>

</polymer-element>


<script src="lib/OrbitControls.js"></script>
<polymer-element name="three-js-orbitControls" extends="three-js-controls" attributes="cameraUp panSpeed zoomSpeed rotateSpeed autoRotate">
  <script>
    Polymer('three-js-orbitControls', {
      autoRotate: false,
      cameraUp : [0,1,0],
      panSpeed : 8.0,
      zoomSpeed: 2.0,
      rotateSpeed: 2.0, 
      autoRotateSpeed:4.0,
      object: null,
      ready: function() {
        this.object = new THREE.OrbitControls();
      },
      init:function(camera, domElement)
      {
        //FIXME: replace renderer with dom element directly, we do not need any other 
        //data from renderer
        this.object.object = camera;
        //this.object.domElement = renderer.domElement;
        this.object.setDomElement( domElement);
        this.object.upVector = this.cameraUp;

		    this.object.userPanSpeed = this.panSpeed;
		    this.object.userZoomSpeed = this.zoomSpeed;
      	this.object.userRotateSpeed = this.rotateSpeed;

		    this.object.autoRotate = this.autoRotate;
		    this.object.autoRotateSpeed = this.autoRotateSpeed;

        //console.log("controls z up", this.cameraUp,"cam",camera,"rend",renderer)
      },
      addToParent3: function() {
        if (this.parentNode.add3 && !this.objectParent) {
          this.objectParent = this.parentNode;
          this.parentNode.add3(this);
          var parentName = this.parentNode.localName;
          console.log('[%s]: request adding to [%s]', this.localName + (this.id ? '#' + this.id : ''), parentName);
        }
      },
      enteredView: function()
      {
        this.cameraUp = new THREE.Vector3(this.cameraUp[0],this.cameraUp[1],this.cameraUp[2]);  
        this.addToParent3();   
      },
      //attribute change handlers
      autoRotateChanged:function()
      {
        this.object.autoRotate = this.autoRotate;
      }
    });
  </script>  

</polymer-element>
